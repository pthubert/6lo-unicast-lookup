



6lo                                                      P. Thubert, Ed.
Internet-Draft                                       Without Affiliation
Intended status: Standards Track                              L. Iannone
Expires: 22 February 2026                                         Huawei
                                                               A. Rashid
                                                     Politecnico di Bari
                                                            T. Pecorella
                                                  University of Florence
                                                          21 August 2025


                 IPv6 Neighbor Discovery Unicast Lookup
                  draft-thubert-6lo-unicast-lookup-03

Abstract

   This document updates RFC 8505 in order to enable unicast address
   lookup from a 6LoWPAN Border Router acting as an Address Registrar.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on 22 February 2026.

Copyright Notice

   Copyright (c) 2025 IETF Trust and the persons identified as the
   document authors.  All rights reserved.











Thubert, et al.         Expires 22 February 2026                [Page 1]

Internet-Draft           IPv6 ND Unicast Lookup              August 2025


   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents (https://trustee.ietf.org/
   license-info) in effect on the date of publication of this document.
   Please review these documents carefully, as they describe your rights
   and restrictions with respect to this document.  Code Components
   extracted from this document must include Revised BSD License text as
   described in Section 4.e of the Trust Legal Provisions and are
   provided without warranty as described in the Revised BSD License.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Terminology . . . . . . . . . . . . . . . . . . . . . . . . .   4
     2.1.  Requirements Language . . . . . . . . . . . . . . . . . .   4
     2.2.  References  . . . . . . . . . . . . . . . . . . . . . . .   4
     2.3.  Acronyms and Initialisms  . . . . . . . . . . . . . . . .   4
     2.4.  New Terms . . . . . . . . . . . . . . . . . . . . . . . .   5
   3.  Overview  . . . . . . . . . . . . . . . . . . . . . . . . . .   6
   4.  Updating RFC 8505 . . . . . . . . . . . . . . . . . . . . . .   7
     4.1.  Extended Neighbor Discovery Options and Messages  . . . .   8
       4.1.1.  Extending the 6LoWQPAN Capability Indication Option
               (6CIO)  . . . . . . . . . . . . . . . . . . . . . . .   8
       4.1.2.  New Code Prefix for Address Mapping Messages  . . . .   9
       4.1.3.  New ARO Status  . . . . . . . . . . . . . . . . . . .   9
     4.2.  Address Mapping Messages  . . . . . . . . . . . . . . . .   9
     4.3.  IPv6 ND-based Address Lookup  . . . . . . . . . . . . . .  11
   5.  Backward Compatibility  . . . . . . . . . . . . . . . . . . .  12
   6.  Security Considerations . . . . . . . . . . . . . . . . . . .  12
   7.  Operational Considerations  . . . . . . . . . . . . . . . . .  12
   8.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  12
     8.1.  ICMPv6 Codes  . . . . . . . . . . . . . . . . . . . . . .  13
     8.2.  New Address Registration Option Status Values . . . . . .  14
     8.3.  New 6LoWPAN Capability Bit  . . . . . . . . . . . . . . .  14
   9.  Acknowledgments . . . . . . . . . . . . . . . . . . . . . . .  14
   10. Normative References  . . . . . . . . . . . . . . . . . . . .  14
   11. Informative References  . . . . . . . . . . . . . . . . . . .  16
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  18

1.  Introduction

   The "Architecture and Framework for IPv6 over Non-Broadcast Access"
   (NBMA) [I-D.ietf-6man-ipv6-over-wireless] introduces an evolution of
   IPv6 ND towards a proactive Address Registration (AR) method.
   Because the IPv6 model for NBMA depends on a routing protocol to
   reach inside the Subnet, the IPv6 ND extension for NBMA is referred
   to as Subnet Neighbor Discovery (SND).  SND is based on work done in
   the context of IoT, known as 6LoWPAN ND.  The components of SND that
   specify the various forms of registration are [RFC6775], [RFC8505],



Thubert, et al.         Expires 22 February 2026                [Page 2]

Internet-Draft           IPv6 ND Unicast Lookup              August 2025


   [RFC9685], and [I-D.ietf-6lo-prefix-registration].  In addition, the
   registration can be secured with [RFC8928], and proxy operations are
   enabled with [RFC8929].

   [RFC8505] defines the Routing Registrar and extends [RFC6775] to use
   a 6LoWPAN Border Router (6LBR) as a central service for Address
   Registration and duplicate detection amongst Routing Registrars and
   possibly individual Nodes that access it directly.

   [RFC8929] introduces the Backbone Router (6BBR) as a Routing
   Registrar that performs IPv6 ND [RFC4861] [RFC4862] proxy operation
   between IPv6 Nodes on a federating Backbone Link and Registering
   Nodes attached to a LowPower Lossy Networks (LLNs) that register
   their addresses to the 6BBR.  The federated links form a Multilink
   Subnet (MLSN).

   The 6BBRs may exchange Extended Duplicate Address Messages (EDAR and
   EDAC) [RFC8505] to register the proxied addresses on behalf of the
   Registering Nodes to the 6LBR.  The Registration Ownership Verifier
   (ROVR) field in the EDAR and EDAC messages is used to correlate
   attempts to register the same address and to detect duplications.
   The ROVR can also be used as a proof-of-ownership (see [RFC8928]) to
   protect the Registered address against theft and impersonation
   attacks (more in [I-D.bi-intarea-savi-wlan]).  Conflicting
   registrations to different 6BBRs for the same Registered address are
   resolved using the TID field, which creates a temporal order and
   enables to recognize the freshest registration.

   With [RFC8929], the Link Layer address (LLA) that the 6BBR advertises
   for a Registered address on behalf of the Registered Node over the
   Backbone can belong to the Registering Node; in that case, the 6BBR
   acts as a Bridging Proxy and bridges the unicast packets.
   Alternatively, the LLA can be that of the 6BBR on the Backbone
   interface, in which case the 6BBR acts as a Routing Proxy, that
   receives the unicast packets at Layer-3 and routes them.  The 6BBR
   signals that LLA in a Source LLA Option (SLLAO) in the EDAR messages
   to the 6LBR, and the 6LBR responds with a Target LLA Option (TLLAO)
   that indicates the LLA associated to the current registration.

   "IPv6 Neighbor Discovery Multicast Address Listener Registration"
   [RFC9685] extends [RFC8505] to register anycast and multicast
   addresses.  This entails accepting more than one registration for the
   same address and the use of the ROVR field as a complement to the
   index.  In that case the 6LBR does not consider multiple
   registrations as duplicate and retains a state for the anycast
   addresses that it can use to reply a query.





Thubert, et al.         Expires 22 February 2026                [Page 3]

Internet-Draft           IPv6 ND Unicast Lookup              August 2025


   It results that the 6LBR is capable of providing the LLA mapping for
   any unicast and anycast address that was proactively registered with
   an SLLAO.  This draft defines the protocol elements and the
   operations to try a unicast Layer-2 lookup with the 6LBR.  This may
   save a reactive IPv6 ND Neighbor Solicitation (NS) message, which is
   based on multicast and may be problematic in extensive wireless
   domains (see [RFC9119]) as well as in large switched fabrics.  In
   case of an anycast address, this draft does not provide a policy/
   logic to select between multiple registrations.

   The registration and lookup services that the 6LBR provides do not
   have to be limited to 6BBRs and are available to any node that
   supports [RFC8505] and [RFC8929] to register an address, and / or
   this specification to resolve a mapping.  The services are available
   on-link using an IPv6 NDP NS and off-link using a new variation of
   the Extended Duplicate Address messages called Address Mapping
   Messages.  The policy and security settings that allow the access to
   the 6LBR are out of scope.

2.  Terminology

2.1.  Requirements Language

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in BCP
   14 [RFC2119] [RFC8174] when, and only when, they appear in all
   capitals, as shown here.

2.2.  References

   This document uses terms and concepts that are discussed in:

   *  "Neighbor Discovery for IP version 6" [RFC4861] and "IPv6
      Stateless address Autoconfiguration" [RFC4862],

   *  Neighbor Discovery Optimization for Low-Power and Lossy Networks
      [RFC6775], as well as

   *  "Registration Extensions for 6LoWPAN Neighbor Discovery" [RFC8505]
      and "IPv6 Backbone Router" [RFC8929].

2.3.  Acronyms and Initialisms

   This document uses the following abbreviations:

   *6BBR:*  6LoWPAN Backbone Router [RFC8929]
   *6CIO:*  6LoWPAN Capability Indication Option [RFC7400]



Thubert, et al.         Expires 22 February 2026                [Page 4]

Internet-Draft           IPv6 ND Unicast Lookup              August 2025


   *6LBR:*  6LoWPAN Border Router [RFC6775]
   *6LN:*  6LoWPAN Node [RFC6775]
   *6LR:*  6LoWPAN Router [RFC6775]
   *AMC:*  Address Mapping Confirmation
   *AMR:*  Address Mapping Request
   *ARO:*  Address Registration Option [RFC6775]
   *DAD:*  Duplicate Address Detection [RFC4861]
   *EARO:*  Extended Address Registration Option [RFC8505]
   *EDAC:*  Extended Duplicate Address Confirmation [RFC8505]
   *EDAR:*  Extended Duplicate Address Request [RFC8505]
   *IPAM:*  IP Address Management
   *LLN:*  Low-Power and Lossy Network
   *LLA:*  Link Layer Address
   *LoWPAN:*  Low-Rate Personal Area Network [IEEE Std 802.15.4]
   *MAC:*  Medium Access Control
   *NA:*  Neighbor Advertisement (message) [RFC4861]
   *NBMA:*  Non-Broadcast Multi-Access (full mesh)
   *NCE:*  Neighbor Cache Entry [RFC4861]
   *ND:*  Neighbor Discovery (protocol)
   *NDP:*  Neighbor Discovery Protocol
   *NS:*  Neighbor Solicitation (message) [RFC4861]
   *ROVR:*  Registration Ownership Verifier (pronounced "rover")
      [RFC8505]
   *RPL:*  IPv6 Routing Protocol for LLNs (pronounced "ripple")
      [RFC6550]
   *RA:*  Router Advertisement (message) [RFC4861]
   *RS:*  Router Solicitation (message) [RFC4861]
   *RTO:*  RPL Target Option [RFC6550]
   *SLLAO:*  Source Link-Layer Address Option [RFC4861]
   *SND:*  Subnet Neighbor Discovery (protocol)
   *TID:*  Transaction ID [RFC8505]
   *TIO:*  Transit Information Option [RFC6550]
   *TLLAO:*  Target Link-Layer Address Option [RFC4861]

2.4.  New Terms

   This document introduces the following terminology:

   *Address Mapping Request (AMR):*  An ICMPv6 message with a type of
      157 (DAR) and a Code Prefix of 1.

   *Address Mapping Confirm (AMC):*  An ICMPv6 message with a type of
      158 (DAC) and a Code Prefix of 1.

   This document uses terminology defined in [RFC8505], in particular:

   *Address Registrar:*  The Address Registrar is an abstract database




Thubert, et al.         Expires 22 February 2026                [Page 5]

Internet-Draft           IPv6 ND Unicast Lookup              August 2025


      that is maintained by the 6LBR to store the state associated with
      its registrations.

   *Address Registration:*  An Address Registration is an abstract state
      associated to one registration, in other words one entry in the
      Address Registrar.

3.  Overview

   Figure 1 illustrates a Backbone Link that federates a collection of
   LLNs as a single IPv6 Subnet, with a number of 6BBRs providing proxy-
   ND services to their attached LLNs.

   A collection of IPv6 Nodes are present on the Backbone side and use
   IPv6 ND [RFC4861][RFC4862] procedures for DAD and Lookup.

   The LLN may be a hub-and-spoke access link such as (Low-Power) Wi-Fi
   [IEEE Std 802.11] and Bluetooth (Low Energy) [IEEE Std 802.15.1], or
   a Route-Over LLN such as the Wi-SUN mesh [Wi-SUN] that leverages
   6LoWPAN [RFC4919][RFC6282] and RPL [RFC6550] over [IEEE Std
   802.15.4].

                    |
                    |
                 +-----+               +-----+       +-----+
       (default) |     |          6LBR |     |       |     | IPv6
          Router |     |               |     |       |     | Node
                 +-----+               +-----+       +-----+
                    |  Backbone side      |             |
        ----+-------+-----------------+---+-------------+----+-----
            |    LLN Side             |                      |
         +------+                 +------+                +------+
         | 6BBR |                 | 6BBR |                | 6BBR |
         |      |                 |      |                |      |
         +------+                 +------+                +------+
            o     Wireless side   o   o  o                  o o
        o o   o  o            o o   o  o  o             o  o  o  o o
       o  o o  o o            o   o  o  o  o            o  o  o o o
       o   o  o  o               o    o  o               o  o   o
         o   o o                    o  o                     o o

         LLN                        LLN                      LLN

   Figure 1: LLN's Connectivity through 6BBR's to Backbone Link and 6LBR







Thubert, et al.         Expires 22 February 2026                [Page 6]

Internet-Draft           IPv6 ND Unicast Lookup              August 2025


   A 6LBR provides registration services for the purpose of proactive
   IPv6 ND and maintains a registry of the active registrations for
   unicast and anycast IPv6 addresses as an abstract data structure
   called an "Address Registrar".  An entry in the Address Registrar is
   called an "Address Registration".

   *The Address Registration retains:*

   *  The value for the ROVR associated to the registration, the current
      value of the TID, and the remaining Lifetime.

   *  A list of LLA's (Link Layer Address) that are associated with the
      IPv6 address and can be used in a TLLAO as a response to a lookup.

   Examples where more than one IP address may be available include the
   case of an anycast address and the case of an LLN address that is
   proxied by more than one 6BBR.

   Unless otherwise configured, a 6LBR does the following:

   *  The 6LBR maintains an entry in the Address Registrar for any type
      of unicast and anycast addresses including those with link-local
      scope.

   *  Based on that entry, it provides Duplicate Address Avoidance (DAA)
      services within the scope of its Address Registrar.

   *  The 6LBR also provides Address Lookup services for the Registered
      Address using unicast ICMPv6 DAR and DAC (As per [RFC8505] EDAR
      and EDAC) based Address Mapping messages.

   The Address Mapping messages can be exchanged using global unicast
   addresses as source and destination addresses, so they can be used
   for both on-link and off-link queries.  NS and NA messages may also
   be used, but in that case the unicast source and destination
   addresses are link-local addresses and the 6LBR must be on-link.

   The 6LBR proactive operations may coexist on the Backbone with
   reactive IPv6 ND [RFC4861][RFC4862] that rely on multicast for
   Duplicate Address Detection (DAD) and Address Lookup.  Nodes that
   support this specification operate with the 6LBR before attempting
   the reactive operation, which may be avoided if the 6LBR is
   conclusive, either detecting a duplication or returning a mapping.

4.  Updating RFC 8505

   This specification leverages the capability to insert IPv6 ND options
   in the EDAR and EDAC messages that was introduced in [RFC8929].



Thubert, et al.         Expires 22 February 2026                [Page 7]

Internet-Draft           IPv6 ND Unicast Lookup              August 2025


   It extends ICMPv6 DAR and DAR messages for Address Lookup in
   Section 4.1.2 that use the same ICMP types as EDAR and EDAC but a
   different Code Prefix.

   It also adds a new Status Value "Address Not Found" in Section 4.1.3
   that indicates that the address being searched is not present in the
   Address Registrar.

   A 6LBR signals itself by setting the B-flag in the 6CIO of the RA
   messages that it generates [RFC8505].  This specification adds a new
   U-flag in the 6CIO to indicate support of Address Mapping (see
   Section 4.1.1).

4.1.  Extended Neighbor Discovery Options and Messages

   This specification does not introduce new options; it modifies
   existing options and updates the associated behaviors.

4.1.1.  Extending the 6LoWQPAN Capability Indication Option (6CIO)

   This specification defines a new capability bit for use in the 6CIO,
   as defined by [RFC7400] and extended in[RFC8505] for use in IPv6 ND
   messages.

   The new "U-flag" indicates that the 6LBR provides address mapping
   services per this specification.



       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |     Type      |   Length = 1  | Experimental  |X|A|D|L|B|P|E|G|
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |F| |U|                       Reserved                          |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                  Figure 2: New Capability Bit in the 6CIO

   6CIO Option Fields:

   *Type:*  36

   *U-Flag:*  The 6LBR provides address mapping services.







Thubert, et al.         Expires 22 February 2026                [Page 8]

Internet-Draft           IPv6 ND Unicast Lookup              August 2025


4.1.2.  New Code Prefix for Address Mapping Messages

   The Extended Duplicate Address messages (EDAR and EDAC) share a
   common base format defined in section 4.2 of [RFC8505], with the
   ICMPv6 type respectively set to 157 and 158 that is inherited from
   the DAR and DAC messages defined in section 4.4 of [RFC6775].  The
   ICMPv6 Code is split in two 4-bit fields, the Code Prefix and the
   Code Suffix, and the only Code Prefix defined in [RFC8505] is 0,
   signaling a DAD operation.

   The Address Mapping messages use the same values for the ICMPv6 Type
   as the corresponding Extended Duplicate Address (EDAR and EDAC)
   messages.  This specification adds the Code Prefix of 1 to signal
   Address Mapping.  ICMPv6 messages with the ICMPv6 type set to 157 or
   158, and a Code Prefix of 1 are thus respectively an Address Mapping
   Request (AMR) and an Address Mapping Confirm (AMC).

4.1.3.  New ARO Status

   The Extended Address Registration Option (EARO) is defined in section
   4.1 of [RFC8505].  It contains a Status field that is common with
   with the EDAR and EDAC messages defined in section 4.2 of [RFC8505].
   This specification defines a new Status "Address Not Found" as
   indicated in Table 1

     +-------+------------------------------------------------------+
     | Value | Description                                          |
     +-------+------------------------------------------------------+
     | 0..10 | As defined in [RFC6775] and [RFC8505]                |
     +-------+------------------------------------------------------+
     | 11    | Address Not Found: The address is not present in the |
     |       | Address Registrar (value to be confirmed by IANA)    |
     +-------+------------------------------------------------------+

                           Table 1: EARO Status

   The Status of "Address Not Found" can be used in an NA(EARO) and in
   an AMC messages as a response to an address lookup operation.

4.2.  Address Mapping Messages

   A 6LBR signals that support by setting the B-flag in the 6CIO of the
   RA messages that it generates.  A 6LBR that supports this
   specification MUST also set the U-flag, indicating support of the
   Address Mapping messages for address lookup.






Thubert, et al.         Expires 22 February 2026                [Page 9]

Internet-Draft           IPv6 ND Unicast Lookup              August 2025


   In the Address Mapping flow, the querier IPv6 Node uses an AMR
   message, which is characterized by an ICMPv6 Type of 157 and a Code
   Prefix of 1.  When used on-link, the AMR message SHOULD carry a SLLAO
   indicating the LLA of the querier.  The Code Suffix MUST be set to 0
   indicating a ROVR Length of 64 bits.  The ROVR, TID and Lifetime
   fields MUST be set to 0 and ignored by the receiver.

   +----------------+                    +----------------+
   |   Querier      |                    |      6LBR      |
   |  IPv6 Node     |                    |                |
   +----------------+                    +----------------+
            |                                     |
            |         1. AMR (EDAR Type 157)      |
            |------------------------------------>|
            | IP Src: Querier's Global Unicast    |
            | IP Dest: 6LBR's Global Unicast      |
            | Code Prefix=1, Code Suffix=0        |
            | ROVR=0, TID=0, Lifetime=0           |
            | SLLAO (Querier LLA)                 |
            |                                     |
            |                                     |
            |                                     |
            |                                     |
            |         2. AMC (EDAC Type 158)      |
            |<------------------------------------|
            | IP Src: 6LBR's Global Unicast       |
            | IP Dest: Querier's Global Unicast   |
            | Code Prefix=1, Code Suffix=0        |
            |                                     |
            |    Case A: Address Not Found        |
            |    Status = "Address Not Found"     |
            |    (No TLLAO)                       |
            |                                     |
            |    Case B: Address Found            |
            |    Status = 0 (Success)             |
            |    TLLAO (LLA from registration)    |
            |                                     |



                     Figure 3: Address Mapping Example

   The 6LBR MUST respond with an AMC message, which is characterized by
   an ICMPv6 Type of 158 and a Code Prefix of 1.







Thubert, et al.         Expires 22 February 2026               [Page 10]

Internet-Draft           IPv6 ND Unicast Lookup              August 2025


   *  If the address is not present in the Address Registrar then the
      6LBR MUST set the status to "Address Not Found".  The Code Suffix
      MUST be set to 0 indicating a ROVR Length of 64 bits.  The ROVR,
      TID and Lifetime fields MUST be set to 0 and ignored by the
      receiver.

   *  Else if the address is present in the Address Registrar then the
      AMC fields MUST be set from the ROVR, TID and remaining Lifetime
      values in the Address Registration and the Status MUST be set to
      0.

   *  If at least one LLA is found in the Address Registration, then the
      6LBR MUST place one in a TLLAO option in the AMC message.

   The AMC is sent unicast the 6LBR to the querier.

4.3.  IPv6 ND-based Address Lookup

   A 6LBR that is deployed on-link SHOULD provide NS/NA-based services.
   It signals that support by setting the L-flag in the 6CIO of the RA
   messages that it generates, indicating that it is a 6LR [RFC8505].

   +---------------------+                     +---------------------+
   |      Querier        |                     |        6LBR         |
   |   (IPv6 Node/6BBR)  |                     |                     |
   +---------------------+                     +---------------------+
            |                                           |
            |  1. NS (SLLAO)                            |
            |------------------------------------------>|
            |  IP Src: Querier's Link-Local             |
            |  IP Dest: 6LBR's Link-Local               |
            |  Target Field: Target IP                  |
            |                                           |
            |                                           |
            |  2. NA (TLLAO, EARO)                      |
            |<------------------------------------------|
            |  IP Src: 6LBR's Link-Local                |
            |  IP Dest: Querier's Link-Local            |
            |  Target Field: Target IP                  |
            |                                           |
            |  Case A: Address Not Found                |
            |  Status = "Address Not Found"             |
            |                                           |
            |  Case B: Address Found                    |
            |  Status = 0 (Success)                     |
            |                                           |

                   Figure 4: IPv6 ND-based Address Lookup



Thubert, et al.         Expires 22 February 2026               [Page 11]

Internet-Draft           IPv6 ND Unicast Lookup              August 2025


   A 6LBR thus typically sets three flags (A, B, and L) when attached to
   a Backbone Link that it serves, as illustrated in Figure 1.  In that
   case, the IPv6 Nodes and 6BBRs can use an NS/NA exchange with the
   6LBR for both duplicate detection and lookup services.

   The NS(Lookup) is sent unicast from link-local address of the querier
   to the link-local address of the 6LBR.  It carries a SLLAO [RFC4861]
   and it MUST NOT carry an EARO option to avoid the confusion with a
   registration.

   The 6LBR MUST respond with an NA message that contains an EARO.

   *  If the address is not present in the Address Registrar then the
      6LBR MUST set the status to "Address Not Found".  The ROVR, TID
      and Lifetime fields MUST be set to 0 and ignored by the receiver.

   *  Else if the address is present in the Address Registrar then the
      EARO fields MUST be set from the ROVR, TID and remaining Lifetime
      values in the Address Registration and the Status MUST be set to
      0.

   *  If at least one LLA is found in the Address Registration, then the
      6LBR MUST place one in a TLLAO in the NA message.

   The NA is sent unicast from link-local address of the 6LBR to the
   link-local address of the querier.

5.  Backward Compatibility

6.  Security Considerations

   This specification extends [RFC8505], and the security section of
   that document also applies to this document.  In particular, the link
   layer SHOULD be sufficiently protected to prevent rogue access.

7.  Operational Considerations

   This specification does not introduce new operational considerations.
   The operational considerations of [RFC8505] apply to this
   specification.

8.  IANA Considerations

   Note to RFC Editor, to be removed: please replace "This RFC"
   throughout this document by the RFC number for this specification
   once it is allocated.





Thubert, et al.         Expires 22 February 2026               [Page 12]

Internet-Draft           IPv6 ND Unicast Lookup              August 2025


   IANA is requested to make a number of changes under the "Internet
   Control Message Protocol version 6 (ICMPv6) Parameters" registry, as
   follows.

8.1.  ICMPv6 Codes

   IANA is requested to create two registries in the ICMPv6 "Code"
   Fields [IANA.ICMP.CODE] registry under the heading "Internet Control
   Message Protocol version 6 (ICMPv6) Parameters", as follows:

   The new registries related to the ICMPv6 Type 157, Duplicate Address
   Request (DAR) (shown in Table 2), and Type 158, Duplicate Address
   Confirmation (DAC) (shown in Table 3), respectively.  For those two
   ICMPv6 types, the ICMPv6 Code field is split into 2 subfields, the
   "Code Prefix" and the "Code Suffix".  Registries related to the "Code
   Suffix" were created in [IANA.ICMP.CODE] upon the publication of
   [RFC8505].

   The new registries relate to the "Code Prefix" portion of the ICMP
   Code.  The range of "Code Prefix" is 0-to-15 in all cases.  The
   policy is "IETF Review" or "IESG Approval" [RFC8126] or both
   registries.

   The new registries are to be initialized as follows:

       +---------------+-----------------------------+-------------+
       | *Code Prefix* | *Meaning*                   | *Reference* |
       +---------------+-----------------------------+-------------+
       | *0*           | Duplicate Address Detection | [RFC6775]   |
       +---------------+-----------------------------+-------------+
       | *1*           | Address Mapping             | This RFC    |
       +---------------+-----------------------------+-------------+
       | *2...15*      | Unassigned                  |             |
       +---------------+-----------------------------+-------------+

         Table 2: Type 157 - Duplicate Address Request Code Prefix















Thubert, et al.         Expires 22 February 2026               [Page 13]

Internet-Draft           IPv6 ND Unicast Lookup              August 2025


       +---------------+-----------------------------+-------------+
       | *Code Prefix* | *Meaning*                   | *Reference* |
       +---------------+-----------------------------+-------------+
       | *0*           | Duplicate Address Detection | [RFC6775]   |
       +---------------+-----------------------------+-------------+
       | *1*           | Address Mapping             | This RFC    |
       +---------------+-----------------------------+-------------+
       | *2...15*      | Unassigned                  |             |
       +---------------+-----------------------------+-------------+

          Table 3: Type 158 - Duplicate Address Confirmation Code
                                   Prefix

8.2.  New Address Registration Option Status Values

   IANA is requested to make additions to the "Address Registration
   Option Status Values" [IANA.ICMP.ARO.STAT] registry under the heading
   "Internet Control Message Protocol version 6 (ICMPv6) Parameters", as
   follows:

          +------------------+-------------------+-------------+
          | *Value*          | *Description*     | *Reference* |
          +------------------+-------------------+-------------+
          | *13 (suggested)* | Address Not Found | This RFC    |
          +------------------+-------------------+-------------+

          Table 4: New Address Registration Option Status Values

8.3.  New 6LoWPAN Capability Bit

   IANA is requested to make an addition to the "6LoWPAN Capability
   Bits" [IANA.ICMP.6CIO] registry under the heading "Internet Control
   Message Protocol version 6 (ICMPv6) Parameters" as indicated in
   Table 5:

   +------------------+----------------------------------+-------------+
   | *Bit*            | *Description*                    | *Reference* |
   +------------------+----------------------------------+-------------+
   | *18 (suggested)* | Address Mapping                  | This RFC    |
   |                  | Support (U-flag)                 |             |
   +------------------+----------------------------------+-------------+

                    Table 5: New 6LoWPAN Capability Bit

9.  Acknowledgments


10.  Normative References



Thubert, et al.         Expires 22 February 2026               [Page 14]

Internet-Draft           IPv6 ND Unicast Lookup              August 2025


   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/info/rfc2119>.

   [RFC4861]  Narten, T., Nordmark, E., Simpson, W., and H. Soliman,
              "Neighbor Discovery for IP version 6 (IPv6)", RFC 4861,
              DOI 10.17487/RFC4861, September 2007,
              <https://www.rfc-editor.org/info/rfc4861>.

   [RFC4862]  Thomson, S., Narten, T., and T. Jinmei, "IPv6 Stateless
              Address Autoconfiguration", RFC 4862,
              DOI 10.17487/RFC4862, September 2007,
              <https://www.rfc-editor.org/info/rfc4862>.

   [RFC6775]  Shelby, Z., Ed., Chakrabarti, S., Nordmark, E., and C.
              Bormann, "Neighbor Discovery Optimization for IPv6 over
              Low-Power Wireless Personal Area Networks (6LoWPANs)",
              RFC 6775, DOI 10.17487/RFC6775, November 2012,
              <https://www.rfc-editor.org/info/rfc6775>.

   [RFC7400]  Bormann, C., "6LoWPAN-GHC: Generic Header Compression for
              IPv6 over Low-Power Wireless Personal Area Networks
              (6LoWPANs)", RFC 7400, DOI 10.17487/RFC7400, November
              2014, <https://www.rfc-editor.org/info/rfc7400>.

   [RFC8126]  Cotton, M., Leiba, B., and T. Narten, "Guidelines for
              Writing an IANA Considerations Section in RFCs", BCP 26,
              RFC 8126, DOI 10.17487/RFC8126, June 2017,
              <https://www.rfc-editor.org/info/rfc8126>.

   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,
              May 2017, <https://www.rfc-editor.org/info/rfc8174>.

   [RFC8505]  Thubert, P., Ed., Nordmark, E., Chakrabarti, S., and C.
              Perkins, "Registration Extensions for IPv6 over Low-Power
              Wireless Personal Area Network (6LoWPAN) Neighbor
              Discovery", RFC 8505, DOI 10.17487/RFC8505, November 2018,
              <https://www.rfc-editor.org/info/rfc8505>.

   [RFC9685]  Thubert, P., Ed., "Listener Subscription for IPv6 Neighbor
              Discovery Multicast and Anycast Addresses", RFC 9685,
              DOI 10.17487/RFC9685, November 2024,
              <https://www.rfc-editor.org/info/rfc9685>.






Thubert, et al.         Expires 22 February 2026               [Page 15]

Internet-Draft           IPv6 ND Unicast Lookup              August 2025


   [I-D.ietf-6lo-prefix-registration]
              Thubert, P., "IPv6 Neighbor Discovery Prefix
              Registration", Work in Progress, Internet-Draft, draft-
              ietf-6lo-prefix-registration-18, 20 August 2025,
              <https://datatracker.ietf.org/doc/html/draft-ietf-6lo-
              prefix-registration-18>.

   [IANA.ICMP.ARO.STAT]
              IANA, "IANA Registry for the Address Registration Option
              Status Value", IANA, https://www.iana.org/assignments/
              icmpv6-parameters/icmpv6-parameters.xhtml#address-
              registration.

   [IANA.ICMP.6CIO]
              IANA, "IANA Registry for the 6LoWPAN Capability Bits",
              IANA, https://www.iana.org/assignments/icmpv6-parameters/
              icmpv6-parameters.xhtml#sixlowpan-capability-bits.

   [IANA.ICMP.CODE]
              IANA, "IANA Registry for the ICMPv6 "Code" Fields", IANA,
              https://www.iana.org/assignments/icmpv6-parameters/
              icmpv6-parameters.xhtml#icmpv6-parameters-3.

11.  Informative References

   [RFC4919]  Kushalnagar, N., Montenegro, G., and C. Schumacher, "IPv6
              over Low-Power Wireless Personal Area Networks (6LoWPANs):
              Overview, Assumptions, Problem Statement, and Goals",
              RFC 4919, DOI 10.17487/RFC4919, August 2007,
              <https://www.rfc-editor.org/info/rfc4919>.

   [RFC6282]  Hui, J., Ed. and P. Thubert, "Compression Format for IPv6
              Datagrams over IEEE 802.15.4-Based Networks", RFC 6282,
              DOI 10.17487/RFC6282, September 2011,
              <https://www.rfc-editor.org/info/rfc6282>.

   [RFC6550]  Winter, T., Ed., Thubert, P., Ed., Brandt, A., Hui, J.,
              Kelsey, R., Levis, P., Pister, K., Struik, R., Vasseur,
              JP., and R. Alexander, "RPL: IPv6 Routing Protocol for
              Low-Power and Lossy Networks", RFC 6550,
              DOI 10.17487/RFC6550, March 2012,
              <https://www.rfc-editor.org/info/rfc6550>.

   [RFC8928]  Thubert, P., Ed., Sarikaya, B., Sethi, M., and R. Struik,
              "Address-Protected Neighbor Discovery for Low-Power and
              Lossy Networks", RFC 8928, DOI 10.17487/RFC8928, November
              2020, <https://www.rfc-editor.org/info/rfc8928>.




Thubert, et al.         Expires 22 February 2026               [Page 16]

Internet-Draft           IPv6 ND Unicast Lookup              August 2025


   [RFC8929]  Thubert, P., Ed., Perkins, C.E., and E. Levy-Abegnoli,
              "IPv6 Backbone Router", RFC 8929, DOI 10.17487/RFC8929,
              November 2020, <https://www.rfc-editor.org/info/rfc8929>.

   [RFC9119]  Perkins, C., McBride, M., Stanley, D., Kumari, W., and JC.
              Zúñiga, "Multicast Considerations over IEEE 802 Wireless
              Media", RFC 9119, DOI 10.17487/RFC9119, October 2021,
              <https://www.rfc-editor.org/info/rfc9119>.

   [I-D.bi-intarea-savi-wlan]
              Xu, M., Wu, J., Lin, T., He, L., and Y. Wang, "A SAVI
              Solution for WLAN", Work in Progress, Internet-Draft,
              draft-bi-intarea-savi-wlan-05, 28 May 2025,
              <https://datatracker.ietf.org/doc/html/draft-bi-intarea-
              savi-wlan-05>.

   [I-D.ietf-6man-ipv6-over-wireless]
              Thubert, P. and M. Richardson, "Architecture and Framework
              for IPv6 over Non-Broadcast Access", Work in Progress,
              Internet-Draft, draft-ietf-6man-ipv6-over-wireless-08, 19
              May 2025, <https://datatracker.ietf.org/doc/html/draft-
              ietf-6man-ipv6-over-wireless-08>.

   [Wi-SUN]   "Wi-SUN Alliance", <https://wi-sun.org/>.

   [IEEE Std 802.15.4]
              IEEE standard for Information Technology, "IEEE Std
              802.15.4, Part. 15.4: Wireless Medium Access Control (MAC)
              and Physical Layer (PHY) Specifications for Low-Rate
              Wireless Personal Area Networks".

   [IEEE Std 802.11]
              IEEE standard for Information Technology, "IEEE Standard
              802.11 - IEEE Standard for Information Technology -
              Telecommunications and information exchange between
              systems Local and metropolitan area networks - Specific
              requirements - Part 11: Wireless LAN Medium Access Control
              (MAC) and Physical Layer (PHY) Specifications.",
              <https://ieeexplore.ieee.org/document/9363693>.

   [IEEE Std 802.15.1]
              IEEE standard for Information Technology, "IEEE Standard
              for Information Technology - Telecommunications and
              Information Exchange Between Systems - Local and
              Metropolitan Area Networks - Specific Requirements. - Part
              15.1: Wireless Medium Access Control (MAC) and Physical
              Layer (PHY) Specifications for Wireless Personal Area
              Networks (WPANs)".



Thubert, et al.         Expires 22 February 2026               [Page 17]

Internet-Draft           IPv6 ND Unicast Lookup              August 2025


Authors' Addresses

   Pascal Thubert (editor)
   Without Affiliation
   06330 Roquefort-les-Pins
   France
   Email: pascal.thubert@gmail.com


   Luigi Iannone
   Huawei Technologies France S.A.S.U.
   18, Quai du Point du Jour
   92100 Boulogne-Billancourt
   France
   Email: luigi.iannone@huawei.com


   Adnan Rashid
   Politecnico di Bari
   Via Edoardo Orabona 4
   70126 Bari
   Italy
   Email: adnan.rashid@poliba.it


   Tommaso Pecorella
   University of Florence
   50139 Florence
   Italy
   Email: tommaso.pecorella@unifi.it





















Thubert, et al.         Expires 22 February 2026               [Page 18]
